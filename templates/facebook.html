{% extends "layout.html" %}

{% block title %} Facebook Login {% endblock %}

{% block main %}

<script>
  function statusChangeCallback(response) {
    console.log('statusChangeCallback');
    console.log(response);
    if (response.status === 'connected') {
      testAPI();
    } else {
      document.getElementById('status').innerHTML = 'Please log into this webpage.';
    }
  }

  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

  window.fbAsyncInit = function() {
    FB.init({
      appId: '3678923479004024',
      cookie: true,
      xfbml: true,
      version: 'v19.0'
    });

    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  };

  function testAPI() {
    console.log('Welcome! Fetching your information....');
    FB.api('/me', function(response) {
      console.log('Successful login for: ' + response.name);
      document.getElementById('status').innerHTML = 'Thanks for logging in, ' + response.name + '!';
    });
  }
</script>

<!-- The JS SDK Login Button -->
<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v19.0&appId=3678923479004024" nonce="rptbFGeS"></script>
<div class="fb-login-button"
     data-width="300"
     data-size="large"
     data-button-type="login_with"
     data-layout="rounded"
     data-auto-logout-link="true"
     data-use-continue-as="true">
</div>

{% endblock %}
